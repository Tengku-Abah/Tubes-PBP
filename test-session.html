<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .cookie-info { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .clear-btn { background: #dc3545; }
        .clear-btn:hover { background: #c82333; }
    </style>
</head>
<body>
    <h1>Session Cookie Test</h1>
    
    <div class="cookie-info">
        <h3>Current Cookies:</h3>
        <div id="cookie-display"></div>
    </div>
    
    <div>
        <button onclick="setAdminCookie()">Set Admin Cookie</button>
        <button onclick="setUserCookie()">Set User Cookie</button>
        <button onclick="clearAllCookies()" class="clear-btn">Clear All Cookies</button>
        <button onclick="refreshCookies()">Refresh Display</button>
    </div>
    
    <div>
        <h3>Test Links:</h3>
        <a href="http://localhost:3001/" target="_blank">Homepage</a> |
        <a href="http://localhost:3001/Login" target="_blank">Login</a> |
        <a href="http://localhost:3001/Admin" target="_blank">Admin</a> |
        <a href="http://localhost:3001/Detail?id=1" target="_blank">Detail</a>
    </div>

    <script>
        function displayCookies() {
            const cookies = document.cookie.split(';').map(c => c.trim()).filter(c => c);
            const display = document.getElementById('cookie-display');
            
            if (cookies.length === 0) {
                display.innerHTML = '<em>No cookies found</em>';
                return;
            }
            
            display.innerHTML = cookies.map(cookie => {
                const [name, value] = cookie.split('=');
                if (name.includes('auth-token')) {
                    try {
                        const parsed = JSON.parse(decodeURIComponent(value));
                        return `<strong>${name}:</strong> ${JSON.stringify(parsed, null, 2)}`;
                    } catch (e) {
                        return `<strong>${name}:</strong> ${value}`;
                    }
                }
                return `<strong>${name}:</strong> ${value}`;
            }).join('<br>');
        }
        
        function setAdminCookie() {
            const adminData = {
                id: 1,
                name: "Admin User",
                email: "admin@test.com",
                role: "admin"
            };
            
            // Clear conflicting cookies
            document.cookie = 'user-auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
            
            // Set admin cookies
            document.cookie = `admin-auth-token=${JSON.stringify(adminData)}; path=/; max-age=2592000`;
            document.cookie = `auth-token=${JSON.stringify(adminData)}; path=/; max-age=2592000`;
            
            refreshCookies();
        }
        
        function setUserCookie() {
            const userData = {
                id: 2,
                name: "Regular User",
                email: "user@test.com",
                role: "user"
            };
            
            // Clear conflicting cookies
            document.cookie = 'admin-auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
            
            // Set user cookies
            document.cookie = `user-auth-token=${JSON.stringify(userData)}; path=/; max-age=2592000`;
            document.cookie = `auth-token=${JSON.stringify(userData)}; path=/; max-age=2592000`;
            
            refreshCookies();
        }
        
        function clearAllCookies() {
            document.cookie = 'auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
            document.cookie = 'admin-auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
            document.cookie = 'user-auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
            refreshCookies();
        }
        
        function refreshCookies() {
            displayCookies();
        }
        
        // Initial display
        displayCookies();
        
        // Auto refresh every 2 seconds
        setInterval(displayCookies, 2000);
    </script>
</body>
</html>