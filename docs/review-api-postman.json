{
    "info": {
        "name": "Review API Collection",
        "description": "Collection untuk testing Review API endpoints",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
        "version": "1.0.0"
    },
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{auth_token}}",
                "type": "string"
            }
        ]
    },
    "variable": [
        {
            "key": "base_url",
            "value": "http://localhost:3000/api",
            "type": "string"
        },
        {
            "key": "auth_token",
            "value": "",
            "type": "string"
        },
        {
            "key": "product_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "review_id",
            "value": "1",
            "type": "string"
        }
    ],
    "item": [
        {
            "name": "Reviews",
            "item": [
                {
                    "name": "Get Reviews",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/reviews?productId={{product_id}}&page=1&limit=10&sortBy=created_at&sortOrder=desc",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "reviews"
                            ],
                            "query": [
                                {
                                    "key": "productId",
                                    "value": "{{product_id}}",
                                    "description": "Filter berdasarkan ID produk"
                                },
                                {
                                    "key": "page",
                                    "value": "1",
                                    "description": "Halaman"
                                },
                                {
                                    "key": "limit",
                                    "value": "10",
                                    "description": "Jumlah item per halaman"
                                },
                                {
                                    "key": "sortBy",
                                    "value": "created_at",
                                    "description": "Field untuk sorting"
                                },
                                {
                                    "key": "sortOrder",
                                    "value": "desc",
                                    "description": "Urutan sorting"
                                }
                            ]
                        }
                    },
                    "response": [
                        {
                            "name": "Success Response",
                            "originalRequest": {
                                "method": "GET",
                                "header": [],
                                "url": {
                                    "raw": "{{base_url}}/reviews?productId=1&page=1&limit=10",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "reviews"
                                    ],
                                    "query": [
                                        {
                                            "key": "productId",
                                            "value": "1"
                                        },
                                        {
                                            "key": "page",
                                            "value": "1"
                                        },
                                        {
                                            "key": "limit",
                                            "value": "10"
                                        }
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"data\": {\n    \"reviews\": [\n      {\n        \"id\": 1,\n        \"productId\": 1,\n        \"userId\": \"a4bc7b55-bee9-4f13-8486-9cb8bb92be29\",\n        \"userName\": \"John Doe\",\n        \"userAvatar\": \"https://example.com/avatar.jpg\",\n        \"rating\": 5,\n        \"comment\": \"Produk sangat bagus!\",\n        \"date\": \"2024-01-15\",\n        \"verified\": true,\n        \"createdAt\": \"2024-01-15T10:30:00Z\",\n        \"updatedAt\": \"2024-01-15T10:30:00Z\"\n      }\n    ],\n    \"pagination\": {\n      \"page\": 1,\n      \"limit\": 10,\n      \"total\": 25,\n      \"totalPages\": 3,\n      \"hasNext\": true,\n      \"hasPrev\": false\n    }\n  }\n}"
                        }
                    ]
                },
                {
                    "name": "Create Review",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"productId\": {{product_id}},\n  \"rating\": 5,\n  \"comment\": \"Produk sangat bagus dan sesuai ekspektasi!\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/reviews",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "reviews"
                            ]
                        }
                    },
                    "response": [
                        {
                            "name": "Success Response",
                            "originalRequest": {
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"productId\": 1,\n  \"rating\": 5,\n  \"comment\": \"Produk sangat bagus dan sesuai ekspektasi!\"\n}"
                                },
                                "url": {
                                    "raw": "{{base_url}}/reviews",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "reviews"
                                    ]
                                }
                            },
                            "status": "Created",
                            "code": 201,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"message\": \"Review berhasil ditambahkan\",\n  \"data\": {\n    \"id\": 1,\n    \"productId\": 1,\n    \"userId\": \"a4bc7b55-bee9-4f13-8486-9cb8bb92be29\",\n    \"userName\": \"John Doe\",\n    \"userAvatar\": \"https://ui-avatars.com/api/?name=John+Doe&background=random\",\n    \"rating\": 5,\n    \"comment\": \"Produk sangat bagus dan sesuai ekspektasi!\",\n    \"date\": \"2024-01-15\",\n    \"verified\": false,\n    \"createdAt\": \"2024-01-15T10:30:00Z\",\n    \"updatedAt\": \"2024-01-15T10:30:00Z\"\n  }\n}"
                        },
                        {
                            "name": "Validation Error",
                            "originalRequest": {
                                "method": "POST",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"productId\": 1,\n  \"rating\": 6,\n  \"comment\": \"Test\"\n}"
                                },
                                "url": {
                                    "raw": "{{base_url}}/reviews",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "reviews"
                                    ]
                                }
                            },
                            "status": "Bad Request",
                            "code": 400,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": false,\n  \"error\": \"Validation Error\",\n  \"message\": \"Rating harus antara 1-5\"\n}"
                        }
                    ]
                },
                {
                    "name": "Update Review",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"reviewId\": {{review_id}},\n  \"rating\": 4,\n  \"comment\": \"Update: Produk bagus tapi ada sedikit kekurangan\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/reviews",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "reviews"
                            ]
                        }
                    },
                    "response": [
                        {
                            "name": "Success Response",
                            "originalRequest": {
                                "method": "PUT",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"reviewId\": 1,\n  \"rating\": 4,\n  \"comment\": \"Update: Produk bagus tapi ada sedikit kekurangan\"\n}"
                                },
                                "url": {
                                    "raw": "{{base_url}}/reviews",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "reviews"
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"message\": \"Review berhasil diperbarui\",\n  \"data\": {\n    \"id\": 1,\n    \"productId\": 1,\n    \"userId\": \"a4bc7b55-bee9-4f13-8486-9cb8bb92be29\",\n    \"userName\": \"John Doe\",\n    \"userAvatar\": \"https://ui-avatars.com/api/?name=John+Doe&background=random\",\n    \"rating\": 4,\n    \"comment\": \"Update: Produk bagus tapi ada sedikit kekurangan\",\n    \"date\": \"2024-01-15\",\n    \"verified\": false,\n    \"createdAt\": \"2024-01-15T10:30:00Z\",\n    \"updatedAt\": \"2024-01-15T11:45:00Z\"\n  }\n}"
                        }
                    ]
                },
                {
                    "name": "Delete Review",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"reviewId\": {{review_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/reviews",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "reviews"
                            ]
                        }
                    },
                    "response": [
                        {
                            "name": "Success Response",
                            "originalRequest": {
                                "method": "DELETE",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"reviewId\": 1\n}"
                                },
                                "url": {
                                    "raw": "{{base_url}}/reviews",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "reviews"
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"message\": \"Review berhasil dihapus\"\n}"
                        }
                    ]
                }
            ]
        },
        {
            "name": "Admin",
            "item": [
                {
                    "name": "Get All Reviews (Admin)",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{auth_token}}"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/admin/reviews?page=1&limit=20&verified=false",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "admin",
                                "reviews"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1",
                                    "description": "Halaman"
                                },
                                {
                                    "key": "limit",
                                    "value": "20",
                                    "description": "Jumlah item per halaman"
                                },
                                {
                                    "key": "verified",
                                    "value": "false",
                                    "description": "Filter berdasarkan status verifikasi"
                                }
                            ]
                        }
                    },
                    "response": [
                        {
                            "name": "Success Response",
                            "originalRequest": {
                                "method": "GET",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    },
                                    {
                                        "key": "Authorization",
                                        "value": "Bearer {{auth_token}}"
                                    }
                                ],
                                "url": {
                                    "raw": "{{base_url}}/admin/reviews?page=1&limit=20",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "admin",
                                        "reviews"
                                    ],
                                    "query": [
                                        {
                                            "key": "page",
                                            "value": "1"
                                        },
                                        {
                                            "key": "limit",
                                            "value": "20"
                                        }
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"data\": {\n    \"reviews\": [\n      {\n        \"id\": 1,\n        \"productId\": 1,\n        \"productName\": \"Laptop Gaming ASUS\",\n        \"userId\": \"a4bc7b55-bee9-4f13-8486-9cb8bb92be29\",\n        \"userName\": \"John Doe\",\n        \"userEmail\": \"john@example.com\",\n        \"userAvatar\": \"https://example.com/avatar.jpg\",\n        \"rating\": 5,\n        \"comment\": \"Produk sangat bagus!\",\n        \"date\": \"2024-01-15\",\n        \"verified\": false,\n        \"createdAt\": \"2024-01-15T10:30:00Z\",\n        \"updatedAt\": \"2024-01-15T10:30:00Z\"\n      }\n    ],\n    \"pagination\": {\n      \"page\": 1,\n      \"limit\": 20,\n      \"total\": 150,\n      \"totalPages\": 8,\n      \"hasNext\": true,\n      \"hasPrev\": false\n    }\n  }\n}"
                        }
                    ]
                },
                {
                    "name": "Update Review (Admin)",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "Bearer {{auth_token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"reviewId\": {{review_id}},\n  \"rating\": 4,\n  \"comment\": \"Review diperbarui oleh admin\",\n  \"verified\": true\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/admin/reviews",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "admin",
                                "reviews"
                            ]
                        }
                    },
                    "response": [
                        {
                            "name": "Success Response",
                            "originalRequest": {
                                "method": "PUT",
                                "header": [
                                    {
                                        "key": "Content-Type",
                                        "value": "application/json"
                                    },
                                    {
                                        "key": "Authorization",
                                        "value": "Bearer {{auth_token}}"
                                    }
                                ],
                                "body": {
                                    "mode": "raw",
                                    "raw": "{\n  \"reviewId\": 1,\n  \"rating\": 4,\n  \"comment\": \"Review diperbarui oleh admin\",\n  \"verified\": true\n}"
                                },
                                "url": {
                                    "raw": "{{base_url}}/admin/reviews",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "admin",
                                        "reviews"
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"message\": \"Review berhasil diperbarui oleh admin\",\n  \"data\": {\n    \"id\": 1,\n    \"productId\": 1,\n    \"productName\": \"Laptop Gaming ASUS\",\n    \"userId\": \"a4bc7b55-bee9-4f13-8486-9cb8bb92be29\",\n    \"userName\": \"John Doe\",\n    \"userEmail\": \"john@example.com\",\n    \"userAvatar\": \"https://example.com/avatar.jpg\",\n    \"rating\": 4,\n    \"comment\": \"Review diperbarui oleh admin\",\n    \"date\": \"2024-01-15\",\n    \"verified\": true,\n    \"createdAt\": \"2024-01-15T10:30:00Z\",\n    \"updatedAt\": \"2024-01-15T12:00:00Z\"\n  }\n}"
                        }
                    ]
                }
            ]
        },
        {
            "name": "Statistics",
            "item": [
                {
                    "name": "Get Review Statistics",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/reviews/stats?productId={{product_id}}",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "reviews",
                                "stats"
                            ],
                            "query": [
                                {
                                    "key": "productId",
                                    "value": "{{product_id}}",
                                    "description": "Statistik untuk produk tertentu"
                                }
                            ]
                        }
                    },
                    "response": [
                        {
                            "name": "Product Statistics",
                            "originalRequest": {
                                "method": "GET",
                                "header": [],
                                "url": {
                                    "raw": "{{base_url}}/reviews/stats?productId=1",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "reviews",
                                        "stats"
                                    ],
                                    "query": [
                                        {
                                            "key": "productId",
                                            "value": "1"
                                        }
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"data\": {\n    \"productId\": 1,\n    \"totalReviews\": 25,\n    \"averageRating\": 4.2,\n    \"ratingDistribution\": {\n      \"5\": 10,\n      \"4\": 8,\n      \"3\": 4,\n      \"2\": 2,\n      \"1\": 1\n    },\n    \"verifiedReviews\": 20,\n    \"unverifiedReviews\": 5,\n    \"recentReviews\": [\n      {\n        \"id\": 1,\n        \"userName\": \"John Doe\",\n        \"userAvatar\": \"https://example.com/avatar.jpg\",\n        \"rating\": 5,\n        \"comment\": \"Produk sangat bagus!\",\n        \"date\": \"2024-01-15\",\n        \"verified\": true\n      }\n    ]\n  }\n}"
                        },
                        {
                            "name": "Global Statistics",
                            "originalRequest": {
                                "method": "GET",
                                "header": [],
                                "url": {
                                    "raw": "{{base_url}}/reviews/stats",
                                    "host": [
                                        "{{base_url}}"
                                    ],
                                    "path": [
                                        "reviews",
                                        "stats"
                                    ]
                                }
                            },
                            "status": "OK",
                            "code": 200,
                            "_postman_previewlanguage": "json",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "cookie": [],
                            "body": "{\n  \"success\": true,\n  \"data\": {\n    \"totalReviews\": 1250,\n    \"averageRating\": 4.1,\n    \"ratingDistribution\": {\n      \"5\": 500,\n      \"4\": 400,\n      \"3\": 200,\n      \"2\": 100,\n      \"1\": 50\n    },\n    \"verifiedReviews\": 1000,\n    \"unverifiedReviews\": 250,\n    \"topRatedProducts\": [\n      {\n        \"productId\": 1,\n        \"productName\": \"Laptop Gaming ASUS\",\n        \"averageRating\": 4.8,\n        \"totalReviews\": 50\n      }\n    ]\n  }\n}"
                        }
                    ]
                }
            ]
        }
    ],
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// Auto-generate auth token if not set",
                    "if (!pm.environment.get('auth_token')) {",
                    "    // You can set a default token here or get it from login",
                    "    pm.environment.set('auth_token', 'your_jwt_token_here');",
                    "}"
                ]
            }
        },
        {
            "listen": "test",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// Auto-save review_id from create response",
                    "if (pm.response.code === 201 && pm.response.json().data?.id) {",
                    "    pm.environment.set('review_id', pm.response.json().data.id);",
                    "}"
                ]
            }
        }
    ]
}